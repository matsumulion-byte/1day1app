<!doctype html>
<html lang="ja">
<head>
  <!-- OGP AUTO-GENERATED START (do not edit by hand) -->
  <meta property="og:title" content="æ¾æ‘ãƒŸã‚¹ãƒ†ãƒªãƒ¼å¤œè©± â€“ ãƒãƒ™ãƒ«å¯„ã›ï¼ˆèƒŒæ™¯/BGM/ãƒ¯ãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—ï¼‰">
  <meta name="twitter:title" content="æ¾æ‘ãƒŸã‚¹ãƒ†ãƒªãƒ¼å¤œè©± â€“ ãƒãƒ™ãƒ«å¯„ã›ï¼ˆèƒŒæ™¯/BGM/ãƒ¯ãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—ï¼‰">
  <meta property="og:description" content="æ¾æ‘ãƒŸã‚¹ãƒ†ãƒªãƒ¼å¤œè©± â€” ç‰©èªã¯ã²ã¨ã¤ã®ãƒœã‚¿ãƒ³ã‹ã‚‰å§‹ã¾ã‚‹ â€” ã‚ˆã†ã“ãã€‚ã“ã‚Œã¯ã€èªã‚‰ã‚Œã–ã‚‹å¤œã‚’è¨˜éŒ²ã™ã‚‹è£…ç½®ã€‚ â–¶ ç‰©èªã‚’å§‹ã‚ã‚‹ ã‚¹ã‚­ãƒƒãƒ—ï¼ˆSpaceï¼‰ ğŸ”„ ã‚‚ã†ä¸€åº¦ ğŸ“‹ ã‚³ãƒ”ãƒ¼ â™ª BGM OFF">
  <meta name="twitter:description" content="æ¾æ‘ãƒŸã‚¹ãƒ†ãƒªãƒ¼å¤œè©± â€” ç‰©èªã¯ã²ã¨ã¤ã®ãƒœã‚¿ãƒ³ã‹ã‚‰å§‹ã¾ã‚‹ â€” ã‚ˆã†ã“ãã€‚ã“ã‚Œã¯ã€èªã‚‰ã‚Œã–ã‚‹å¤œã‚’è¨˜éŒ²ã™ã‚‹è£…ç½®ã€‚ â–¶ ç‰©èªã‚’å§‹ã‚ã‚‹ ã‚¹ã‚­ãƒƒãƒ—ï¼ˆSpaceï¼‰ ğŸ”„ ã‚‚ã†ä¸€åº¦ ğŸ“‹ ã‚³ãƒ”ãƒ¼ â™ª BGM OFF">
  <meta property="og:url" content="/apps/2025-10-07/index.html">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <!-- OGP AUTO-GENERATED END -->

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>æ¾æ‘ãƒŸã‚¹ãƒ†ãƒªãƒ¼å¤œè©± â€“ ãƒãƒ™ãƒ«å¯„ã›ï¼ˆèƒŒæ™¯/BGM/ãƒ¯ãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—ï¼‰</title>

<style>
  :root{
    --bg0:#050505;
    --ink:#ececec;
    --muted:#a6a6a6;
    --panel:max(320px, min(860px, 92vw));
    --line-h:2.05;
    --token:70ms;   /* å˜èªï¼ˆãƒˆãƒ¼ã‚¯ãƒ³ï¼‰ã”ã¨ã®é–“éš”ï¼ˆå°‘ã—ã‚†ã£ãã‚Šã«ï¼‰ */
    --fade:700ms;   /* è¡Œãƒ•ã‚§ãƒ¼ãƒ‰ */
    --kenburns-scale:1.08;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;background:#000;color:var(--ink);font-family:"Hiragino Mincho ProN","Yu Mincho","æ¸¸æ˜æœ","Noto Serif JP",serif}
  body{display:flex;align-items:center;justify-content:center;overflow:hidden}
/* CSSå†…ã«èª¤ã£ã¦æ··å…¥ã—ã¦ã„ãŸJSã‚’å‰Šé™¤ï¼ˆJSã¯ä¸‹éƒ¨<script>å†…ã§å®Ÿè¡Œï¼‰ */

  /* èƒŒæ™¯ï¼ˆç”»åƒï¼‹æš—å¹•ï¼‹ãƒã‚¤ã‚ºï¼‹ã‚±ãƒ³ãƒãƒ¼ãƒ³ã‚ºï¼‰ */
  .bg{position:fixed;inset:0;z-index:0;overflow:hidden;pointer-events:none}
  .bg::before{
    content:"";position:absolute;inset:-3%;
    background:#000 center/cover no-repeat;
    background-image: var(--bg-url, none);
    transform: scale(1); animation: kenburns 30s ease-in-out infinite alternate;
    filter: saturate(1) brightness(1.02) contrast(1.0);
  }
  @keyframes kenburns{to{transform:scale(var(--kenburns-scale)) translate3d(1.2%,0,0)}}
  .veil{position:fixed;inset:0;background:radial-gradient(120% 150% at 50% -20%, rgba(0,0,0,.18), rgba(0,0,0,.5));z-index:1;pointer-events:none}
  .grain{position:fixed;inset:-10%;z-index:2;opacity:.06;mix-blend-mode:soft-light;pointer-events:none;
    background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='60' height='60'><filter id='n'><feTurbulence type='fractalNoise' baseFrequency='0.7' numOctaves='2'/></filter><rect width='100%' height='100%' filter='url(%23n)'/></svg>");
    animation:grain 1.7s steps(2,end) infinite}
  @keyframes grain{0%{transform:translate(0,0)}25%{transform:translate(-1%,1%)}50%{transform:translate(1%,-1%)}75%{transform:translate(.5%,.5%)}100%{transform:translate(0,0)}}

  /* æ  */
  .stage{width:var(--panel);padding:28px 18px 22px;border-radius:16px;border:1px solid rgba(255,255,255,.08);
    background:linear-gradient(180deg, rgba(20,20,20,.55), rgba(10,10,10,.45));
    backdrop-filter: blur(3px); box-shadow:0 20px 60px rgba(0,0,0,.6); position:relative; z-index:5}
  .title{letter-spacing:.08em;text-align:center;margin:0 0 8px;font-size:clamp(18px,2.6vw,22px)}
  .sub{color:var(--muted);text-align:center;margin:0 0 14px;font-size:clamp(11px,1.9vw,12px)}

  .screen{min-height:60vh;max-height:68vh;overflow:auto;padding:20px 18px;border-radius:12px;border:1px solid rgba(255,255,255,.08);
    background:rgba(0,0,0,.35);line-height:var(--line-h)}
  .line{opacity:0;transform:translateY(2px);transition:opacity var(--fade) ease, transform var(--fade) ease;margin:0 0 .9em}
  .line.show{opacity:1;transform:none}
  .center{text-align:center}
  .muted{color:var(--muted)}
  .caret{display:inline-block;width:.6ch;border-right:1px solid rgba(255,255,255,.45);animation:blink 1s step-end infinite}
  @keyframes blink{50%{border-color:transparent}}

  .controls{display:flex;gap:8px;flex-wrap:wrap;justify-content:center;margin-top:14px}
  button{appearance:none;border:1px solid rgba(255,255,255,.14);background:rgba(15,15,15,.8);color:var(--ink);
    padding:10px 14px;border-radius:999px;cursor:pointer;font:inherit;letter-spacing:.02em}
  button:hover{border-color:rgba(255,255,255,.28);box-shadow:0 0 0 2px rgba(255,255,255,.08)}
  button:disabled{opacity:.55;cursor:not-allowed}
  .primary{background:linear-gradient(180deg,#171717,#0f0f0f)}
  .tiny{font-size:12px;padding:6px 10px}
  .ghost{background:transparent}

  /* æš—è»¢ */
  .cut{position:fixed;inset:0;background:#000;opacity:0;pointer-events:none;transition:opacity 600ms ease;z-index:9}
  .cut.show{opacity:1}

  @media (prefers-reduced-motion: reduce){
    .bg::before,.grain{animation:none}
    .cut,.line{transition:none}
    :root{--token:0ms;--fade:0ms}
  }
</style>
</head>
<body>
  <!-- èƒŒæ™¯ -->
  <div class="bg" id="bg"></div>
  <div class="veil"></div>
  <div class="grain"></div>
  <div class="cut" id="cut"></div>

  <div class="stage" role="application" aria-label="ã‚µã‚¦ãƒ³ãƒ‰ãƒãƒ™ãƒ«é¢¨ãƒ»è‡ªå‹•ç”Ÿæˆã‚¢ãƒ—ãƒª">
    <h1 class="title">æ¾æ‘ãƒŸã‚¹ãƒ†ãƒªãƒ¼å¤œè©±</h1>
    <p class="sub">â€” ç‰©èªã¯ã²ã¨ã¤ã®ãƒœã‚¿ãƒ³ã‹ã‚‰å§‹ã¾ã‚‹ â€”</p>

    <div id="screen" class="screen" aria-live="polite">
      <p class="line show muted">ã‚ˆã†ã“ãã€‚ã“ã‚Œã¯ã€èªã‚‰ã‚Œã–ã‚‹å¤œã‚’è¨˜éŒ²ã™ã‚‹è£…ç½®ã€‚</p>
    </div>

    <div class="controls">
      <button id="start" class="primary">â–¶ ç‰©èªã‚’å§‹ã‚ã‚‹</button>
      <button id="skip"  class="tiny ghost" disabled>ã‚¹ã‚­ãƒƒãƒ—ï¼ˆSpaceï¼‰</button>
      <button id="again" class="tiny ghost" disabled>ğŸ”„ ã‚‚ã†ä¸€åº¦</button>
      <button id="copy"  class="tiny ghost" disabled>ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
      <button id="bgmBtn" class="tiny ghost">â™ª BGM OFF</button>
    </div>

    <!-- éŸ³æºï¼ˆä»»æ„ï¼‰ï¼šBGM ã®ã¿ä½¿ç”¨ -->
    <audio id="bgm"   preload="none" loop></audio>
  </div>

<script>
/* ===== èƒŒæ™¯ç”»åƒï¼ˆä»»æ„ï¼‰ ===== */
(function setBg(){
  // ç¾åœ¨ã®ãƒ‘ã‚¹ã‚’åŸºæº–ã«ã‚¢ã‚»ãƒƒãƒˆã®çµ¶å¯¾URLã‚’ç”Ÿæˆï¼ˆ/2025-10-07 ãªã©ï¼‰
  const basePath = (function(){
    try{
      const p = location.pathname;
      // æœ«å°¾ãŒ "/" ã®å ´åˆã¯ãã®ã¾ã¾ã€ãã‚Œä»¥å¤–ã¯ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªéƒ¨åˆ†ã‚’æ¡ç”¨
      if (p.endsWith('/')) return p.replace(/\/$/, '');
      const m = p.match(/^\/(\d{4}-\d{2}-\d{2})(?:\/.+)?$/);
      return m ? `/${m[1]}` : '';
    }catch(e){ return ''; }
  })();
  // ãƒ•ã‚©ãƒ«ãƒ€ã®èƒŒæ™¯ç”»åƒã‹ã‚‰ãƒ­ãƒ¼ãƒ‰å¯èƒ½ãª1æšã‚’é¸æŠï¼ˆãƒ—ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦ç¢ºèªï¼‰
  const candidates = [
    `${basePath}/bg/bg1.png`,
    `${basePath}/bg/bg2.png`,
    `${basePath}/bg/bg3.png`,
    `${basePath}/bg/bg4.png`
  ];
  const applyBg = (src)=>{
    const url = `url('${src}')`;
    document.documentElement.style.setProperty('--bg-url', url);
    const bgEl = document.getElementById('bg');
    if (bgEl) {
      bgEl.style.setProperty('--bg-url', url);
      bgEl.style.backgroundImage = url; // ç›´æ¥æŒ‡å®šã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
      bgEl.style.backgroundPosition = 'center';
      bgEl.style.backgroundSize = 'cover';
    }
  };
  const tryNext = (i)=>{
    if (i >= candidates.length){ applyBg(`${basePath}/bg.jpg`); return; }
    const img = new Image();
    img.onload = ()=> applyBg(candidates[i]);
    img.onerror = ()=> tryNext(i+1);
    img.src = candidates[i];
  };
  tryNext(Math.floor(Math.random()*candidates.length));
})();

/* ===== ãƒ‡ãƒ¼ã‚¿ ===== */
const D = {
  prologues: [
    "éœ§ãŒè¡—ã‚’åŒ…ã¿ã€è¶³éŸ³ã ã‘ãŒéŸ¿ã„ã¦ã„ãŸã€‚",
    "ç›®ã‚’è¦šã¾ã™ã¨ã€æœºã®ä¸Šã«ã¯å†·ã‚ãŸã‚³ãƒ¼ãƒ’ãƒ¼ãŒã‚ã£ãŸã€‚",
    "é›¨éŸ³ã®å‘ã“ã†ã§ã€èª°ã‹ãŒãƒ”ã‚¢ãƒã‚’å¼¾ã„ã¦ã„ã‚‹æ°—ãŒã—ãŸã€‚",
    "æœ€å¾Œã«ç¬‘ã£ãŸã®ã¯ã€èª°ã ã£ãŸã‚ã†ã‹ã€‚"
  ],
  titlesA: ["é›ªã«æ¶ˆãˆãŸ","é»’ã„","æœ€å¾Œã®","è¨˜éŒ²ã•ã‚Œãªã‹ã£ãŸ","æ²ˆé»™ã®","åä¸‰ç•ªç›®ã®"],
  titlesB: ["æ¼”å¥ä¼š","è¨¼è¨€","è‚–åƒ","æ‰‹è¨˜","å½±","æ‹›å¾…çŠ¶"],
  characters: ["æ¾æ‘åˆ‘äº‹","ç„¡å£ãªé’å¹´","è¬ã®ç”»å®¶","æ²ˆé»™ã®ãƒ”ã‚¢ãƒ‹ã‚¹ãƒˆ","AIç ”ç©¶è€…","å¤æ›¸åº—ã®å¥³ä¸»äºº"],
  incidents: [
    "é¡ãŒã™ã¹ã¦å‰²ã‚Œã¦ã„ãŸ","æ™‚è¨ˆãŒé€†ã«å›ã£ã¦ã„ãŸ","æ¥½è­œãŒèµ¤ã„ã‚¤ãƒ³ã‚¯ã§å¡—ã‚Šã¤ã¶ã•ã‚Œã¦ã„ãŸ",
    "ãƒ‰ã‚¢ã¯å†…å´ã‹ã‚‰éµãŒã‹ã‹ã£ã¦ã„ãŸ","SNSã®ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ãŒçŸ›ç›¾ã—ã¦ã„ãŸ"
  ],
  clues: ["å°ã•ãªãƒœã‚¤ã‚¹ãƒ¬ã‚³ãƒ¼ãƒ€ãƒ¼","å¤ã³ãŸå†™çœŸ","åˆ‡ã‚ŠæŠœã‹ã‚ŒãŸæ–°è","é»’ã„éµ","æœªé€ä¿¡ã®ãƒ¡ãƒ¼ãƒ«"],
  moves: [
    "èª°ã‹ãŒè¨˜æ†¶ã‚’ã™ã‚Šæ›¿ãˆãŸ","å½±æ­¦è€…ãŒã„ãŸ","éŒ²éŸ³ãŒä»•æ›ã‘ã‚‰ã‚Œã¦ã„ãŸ",
    "ç›£è¦–ã‚«ãƒ¡ãƒ©ã®æ­»è§’ãŒä½œã‚‰ã‚Œã¦ã„ãŸ","AIãŒç”»åƒã‚’å½è£…ã—ã¦ã„ãŸ"
  ],
  quotes: [
    "ã€Œã“ã“ã‹ã‚‰ãŒæœ¬å½“ã®ã¯ã˜ã¾ã‚Šã ã€","ã€ŒéŸ³ã¯ã€å˜˜ã‚’ã¤ã‹ãªã„ã€",
    "ã€Œã‚ãªãŸã¯ã€ä½•ã‚’è¦‹ãŸã¨è¨€ãˆã‚‹ï¼Ÿã€","ã€Œè¨˜éŒ²ã¯ã€è¨˜æ†¶ã‚ˆã‚Šæ­£ç¢ºã ã¨ã¯é™ã‚‰ãªã„ã€"
  ],
  twists: [
    "çŠ¯äººã¯è‡ªåˆ†è‡ªèº«ã ã£ãŸ","èª°ã‚‚æ­»ã‚“ã§ã„ãªã‹ã£ãŸ","äº‹ä»¶ã¯ã¾ã å§‹ã¾ã£ã¦ã„ãªã‹ã£ãŸ",
    "ã™ã¹ã¦ã¯AIãŒç”Ÿæˆã—ãŸè¨˜æ†¶ã ã£ãŸ","æ¾æ‘ã¯å­˜åœ¨ã—ãªã‹ã£ãŸ"
  ],
  codas: [
    "â€¦â€¦ã¤ã¾ã‚Šã€çœŸå®Ÿã¯æœ€åˆã‹ã‚‰ç›®ã®å‰ã«ã‚ã£ãŸã®ã ã€‚",
    "ãã—ã¦ã€é™ã‘ã•ã ã‘ãŒéƒ¨å±‹ã«æ®‹ã£ãŸã€‚",
    "é›¨ã¯ã€ä½•äº‹ã‚‚ãªã‹ã£ãŸã‹ã®ã‚ˆã†ã«é™ã‚Šç¶šã„ã¦ã„ãŸã€‚"
  ]
};
const pick = a => a[Math.floor(Math.random()*a.length)];

/* ===== è¦ç´  ===== */
const screen = document.getElementById('screen');
const start  = document.getElementById('start');
const skipBt = document.getElementById('skip');
const again  = document.getElementById('again');
const copyBt = document.getElementById('copy');
const cut    = document.getElementById('cut');
const bgm    = document.getElementById('bgm');
const bgmBtn = document.getElementById('bgmBtn');

// BGM å€™è£œï¼ˆãƒ©ãƒ³ãƒ€ãƒ å†ç”Ÿï¼‰: ç¾åœ¨ãƒ«ãƒ¼ãƒˆã«åˆã‚ã›ã¦è§£æ±º
const ROUTE_BASE = (function(){
  try{
    const p = location.pathname;
    if (p.endsWith('/')) return p.replace(/\/$/, '');
    const m = p.match(/^\/(\d{4}-\d{2}-\d{2})(?:\/.+)?$/);
    return m ? `/${m[1]}` : '';
  }catch(e){ return ''; }
})();
const bgms = [
  `${ROUTE_BASE}/bgm/bgm1.mp3`,
  `${ROUTE_BASE}/bgm/bgm2.mp3`,
  `${ROUTE_BASE}/bgm/bgm3.mp3`
];

function pickRandom(list){ return list[Math.floor(Math.random()*list.length)]; }

// åˆæœŸBGMã‚’è¨­å®šï¼ˆãƒœã‚¿ãƒ³ã§å³å†ç”Ÿã§ãã‚‹ã‚ˆã†ã«ï¼‰
if (bgm && !bgm.src){ bgm.src = pickRandom(bgms); }

/* ===== ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ ===== */
const wait = ms => new Promise(r=>setTimeout(r,ms));
function line(text, cls=""){
  const p = document.createElement('p');
  p.className = `line ${cls}`.trim();
  screen.appendChild(p);
  requestAnimationFrame(()=> p.classList.add('show'));
  return p;
}
async function blackout(on=true){ cut.classList.toggle('show', on); await wait(550); }

/* ===== æ–‡å­—è¡¨ç¤ºï¼šå˜èªã”ã¨ã«â€œã‚¹ãƒƒâ€ã¨å‡ºã™ ===== */
let typing=false, skipNow=false;
function tokenize(text){
  // ç©ºç™½ã‚‚ä¿æŒã€å¥èª­ç‚¹ã‚‚å˜ç‹¬ãƒˆãƒ¼ã‚¯ãƒ³åŒ–
  return text.split(/(\s+|ã€|ã€‚|ï¼Œ|ï¼|â€¦|â€”|â€•|ï¼|!|ï¼Ÿ|\?)/g).filter(t=>t!==undefined && t!=="");
}
async function typeParagraph(text, cls=""){
  const p = line("", cls);
  typing = true;
  const tokens = tokenize(text);
  const base = parseInt(getComputedStyle(document.documentElement).getPropertyValue("--token")) || 42;

  for (let i=0;i<tokens.length;i++){
    if (skipNow){ p.textContent = text; break; }
    p.textContent += tokens[i];
    let d = base;
    if (/[ã€ï¼Œ]/.test(tokens[i])) d *= 2.2;
    if (/[ã€‚ï¼â€¦!?ï¼ï¼Ÿâ€”â€•]/.test(tokens[i])) d *= 3.6;
    await wait(d);
    screen.scrollTop = screen.scrollHeight;
  }
  // è»½ã„ã‚«ãƒ¼ã‚½ãƒ«æ¼”å‡ºï¼ˆæœ€å¾Œã ã‘ä¸€ç¬ï¼‰
  const c = document.createElement('span'); c.className = 'caret';
  p.appendChild(c); await wait(350); c.remove();

  typing=false; skipNow=false; screen.scrollTop = screen.scrollHeight;
}

/* ===== ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ç”Ÿæˆ ===== */
function makeTitle(){ return `${pick(D.titlesA)}${pick(D.titlesB)}`; }
function makeStory(){
  return [
    {t:`ã€ ${makeTitle()} ã€‘`, cls:"center"},
    {t: pick(D.prologues)},
    {t:""},
    {t:`ç™»å ´äººç‰©ã¯ã€${pick(D.characters)}ã€‚`},
    {t:`ç¾å ´ã«ã¯ã€${pick(D.incidents)}ã¨ã„ã†å¥‡å¦™ãªç—•è·¡ãŒæ®‹ã£ã¦ã„ãŸã€‚`},
    {t:`æ‰‹ãŒã‹ã‚Šã¯ã€${pick(D.clues)}ãŸã ã²ã¨ã¤ã€‚`},
    {t: pick(D.quotes), cls:"center"},
    {t:`â€”â€” ${pick(D.moves)}ã€‚`},
    {t:`çœŸç›¸ã¯ã€${pick(D.twists)}ã€‚`},
    {t: pick(D.codas)},
    {t:"â€¦â€¦ãã—ã¦ã€ã™ã¹ã¦ã‚’è¦‹å±Šã‘ãŸã®ã¯â€”â€”æ¾æ‘ã ã‘ã ã£ãŸã€‚", cls:"center"}
  ];
}

/* ===== é€²è¡Œ ===== */
async function play(){
  start.disabled = true; skipBt.disabled = false; again.disabled = true; copyBt.disabled = true;

// ã‚¹ãƒˆãƒ¼ãƒªãƒ¼é–‹å§‹æ™‚ã«ãƒ©ãƒ³ãƒ€ãƒ BGMè¨­å®š
try{
  const chosen = bgms[Math.floor(Math.random()*bgms.length)];
  bgm.src = chosen;
  bgm.volume = 0.28;
  await bgm.play().catch(()=>{});
}catch(e){}


  await blackout(true);
  screen.innerHTML = "";
  await wait(250);

  const story = makeStory();

  await blackout(false);
  await typeParagraph(story[0].t, story[0].cls||"");
  await wait(400);
  for (let i=1;i<story.length;i++){
    skipBt.disabled = false;
    await typeParagraph(story[i].t, story[i].cls||"");
    skipBt.disabled = true;
    if (story[i].t==="") await wait(220);
  }

  // èª­äº†ãƒœã‚¤ã‚¹ã¯æœªä½¿ç”¨

  start.textContent = "â–¶ åˆ¥ã®ç‰©èªã‚’å§‹ã‚ã‚‹";
  start.disabled = false;
  again.disabled = false;
  copyBt.disabled = false;
}
start.addEventListener('click', play);

skipBt.addEventListener('click', ()=>{ if(typing) skipNow = true; });
window.addEventListener('keydown', e=>{
  if (e.code === 'Space'){ e.preventDefault(); if(typing) skipNow = true; }
});

again.addEventListener('click', async ()=>{
  screen.innerHTML = "";
  line("â€”â€” äº‹ä»¶ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å†ç”Ÿã—ã¾ã™ã€‚","muted show");
  await wait(300);
  start.click();
});

copyBt.addEventListener('click', async ()=>{
  const text = [...screen.querySelectorAll('.line')].map(n=>n.textContent).join("\n");
  try{
    await navigator.clipboard.writeText(text);
    copyBt.textContent = "ğŸ“‹ ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ";
    setTimeout(()=>copyBt.textContent="ğŸ“‹ ã‚³ãƒ”ãƒ¼", 1200);
  }catch(e){ alert("ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ"); }
});

/* ===== BGM ON/OFF ===== */
let bgmOn = false;
bgmBtn.addEventListener('click', async ()=>{
  try{
    if (!bgm || !bgm.src){ return; }
    if (bgm.paused){
      await bgm.play();
      bgm.volume = 0.28;
      bgmBtn.textContent = "â™ª BGM ON";
    } else {
      bgm.pause();
      bgmBtn.textContent = "â™ª BGM OFF";
    }
  }catch(e){}
});
</script>
</body>
</html>
