<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,user-scalable=no" />
<title>ã€‡ã€‡ã¨ã€‡ã€‡ã¨ã€‡ã€‡ã§ã™ã€‚ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆ</title>
<style>
  :root{ --bg:#0b1014; --ink:#e9f1f7; --acc:#7ad1ff; --shadow:0 6px 20px rgba(0,0,0,.35) }
  *{ box-sizing:border-box; -webkit-tap-highlight-color:transparent }
  html,body{ margin:0; height:100%; background:var(--bg); color:var(--ink); font-family: system-ui, -apple-system, "Hiragino Kaku Gothic ProN", "Yu Gothic", sans-serif; overflow:hidden; touch-action:manipulation; }
  main{ display:flex; flex-direction:column; justify-content:center; align-items:center; height:100%; text-align:center; position:relative; }
  h1{ font-size:clamp(18px,5vw,28px); margin-bottom:24px; letter-spacing:.05em }
  .reels{ display:flex; justify-content:center; align-items:center; gap:8px; margin-bottom:32px }
  .slot{ width:28vw; max-width:140px; height:140px; background:rgba(255,255,255,.05); border-radius:16px; display:flex; justify-content:center; align-items:center; font-weight:700; font-size:22px; border:1px solid rgba(255,255,255,.1); box-shadow:var(--shadow); }
  button{ appearance:none; border:none; background:#1a2534; color:var(--ink); padding:14px 32px; border-radius:14px; font-weight:700; font-size:16px; margin:6px; box-shadow:var(--shadow); }
  button:active{ transform:translateY(2px); opacity:.9 }

  .confetti{ position:fixed; inset:0; pointer-events:none; z-index:5 }
  @keyframes flash{ 0%{filter:brightness(1.7)}100%{filter:brightness(1)} }
  .flash{ animation:flash .5s ease }

  .msg{ position:fixed; inset:0; display:flex; justify-content:center; align-items:center; pointer-events:none; font-weight:800; font-size:clamp(20px,6vw,40px); opacity:0; transition:opacity .3s, transform .3s; z-index:10 }
  .msg.show{ opacity:1; transform:scale(1.05); }
  .msg.pop{ animation:pop .6s cubic-bezier(.2,1.5,.3,1) }
  @keyframes pop{ 0%{ transform:scale(.8) } 60%{ transform:scale(1.1) } 100%{ transform:scale(1.0) } }
  .msg-content{ background:rgba(0,0,0,.5); backdrop-filter:blur(8px); padding:20px 32px; border-radius:20px; color:#fff; text-shadow:0 0 20px rgba(255,255,255,.3); }
  .tuk{ color:#ff6b7a; display:block; margin-top:6px; text-shadow:0 0 20px rgba(255,107,122,.4); }

  /* æ´¾æ‰‹â‘ ï¼šæ”¾å°„ãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚° */
  .rays{ position:fixed; inset:0; pointer-events:none; opacity:0; transition:opacity .25s ease; z-index:6 }
  .rays.on{ opacity:1; }
  .rays::before{ content:""; position:absolute; left:50%; top:45%; width:160vmax; height:160vmax; transform:translate(-50%,-50%) rotate(0deg); background:
    repeating-conic-gradient(from 0deg, rgba(255,215,130,.45) 0 6deg, rgba(255,215,130,0) 6deg 18deg);
    -webkit-mask: radial-gradient(circle at center, rgba(0,0,0,1) 0 55%, rgba(0,0,0,.8) 70%, rgba(0,0,0,0) 85%);
    mask: radial-gradient(circle at center, rgba(0,0,0,1) 0 55%, rgba(0,0,0,.8) 70%, rgba(0,0,0,0) 85%);
    animation: spin 4s linear infinite;
    filter: blur(4px) saturate(1.1);
  }
  @keyframes spin{ to{ transform:translate(-50%,-50%) rotate(360deg) } }

  /* æ´¾æ‰‹â‘¢ï¼šè™¹ã‚°ãƒ©èƒŒæ™¯ */
  .rainbow{ position:fixed; inset:-20%; background:linear-gradient(120deg, #ff6b7a, #ffd36e, #8ae6a2, #7ad1ff, #b89cff, #ff9ed1, #ff6b7a); background-size:400% 400%; filter:saturate(1.2) blur(6px); opacity:0; pointer-events:none; mix-blend-mode:screen; transition:opacity .25s ease; z-index:4 }
  .rainbow.on{ opacity:.55; animation:flow 2.8s ease both; }
  @keyframes flow{ 0%{ background-position:0% 50% } 50%{ background-position:100% 50% } 100%{ background-position:0% 50% } }
</style>
</head>
<body>
<main>
  <h1>ã€‡ã€‡ã¨ã€‡ã€‡ã¨ã€‡ã€‡ã§ã™ã€‚ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆ</h1>
  <div class="reels">
    <div class="slot" id="slot1">ä¸€ç¾</div>
    <div class="slot" id="slot2">å®¶æ°¸</div>
    <div class="slot" id="slot3">æ¾æ‘ã§ã™ã€‚</div>
  </div>
  <div>
    <button id="btnStart">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
    <button id="btnStop">ã‚¹ãƒˆãƒƒãƒ—</button>
  </div>

  <!-- æ¼”å‡ºãƒ¬ã‚¤ãƒ¤ -->
  <div class="msg" id="msg"><div class="msg-content" id="msgContent"></div></div>
  <canvas class="confetti" id="confetti"></canvas>
  <div class="rays" id="rays"></div>
  <div class="rainbow" id="rainbow"></div>
</main>
<script>
// ===== ãƒ‡ãƒ¼ã‚¿ï¼ˆå½“ãŸã‚Šã‚„ã™ã•ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°è¾¼ã¿ï¼‰ =====
const LEFT = ["ä¸€ç¾","ä¸€ç¾","ä¸€ç¾","ã•ã¨ã¿","ã‚Šã•","ã‹ãª","ã¾ã„","ãˆã‚Š","ã¨ã‚‚ã¿"];
const MID  = ["å®¶æ°¸","å®¶æ°¸","å®¶æ°¸","å±±æœ¬","ç”°ä¸­","éˆ´æœ¨","ä½è—¤","æ‘ä¸Š","é’æŸ³"];
const RIGHT = Array(4).fill("æ¾æ‘ã§ã™ã€‚").concat(["æ‘æ¾ã§ã™ã€‚","å‰æ‘ã§ã™ã€‚","æ¾æ‘ã§ã™ã‹ï¼Ÿ","æ¾æµ¦ã§ã™ã€‚","æ¾ç”°ã§ã™ã€‚"]);
const CORRECT = ["ä¸€ç¾","å®¶æ°¸","æ¾æ‘ã§ã™ã€‚"];

const slots=[document.getElementById('slot1'),document.getElementById('slot2'),document.getElementById('slot3')];
let spinning=false, raf;

// ===== ã‚µã‚¦ãƒ³ãƒ‰ =====
let AC; try{ AC = new (window.AudioContext||window.webkitAudioContext)(); }catch(e){}
function beep(freq,dur,type='sine',vol=.15){ try{ const o=AC.createOscillator(), g=AC.createGain(); o.type=type; o.frequency.value=freq; g.gain.value=vol; o.connect(g).connect(AC.destination); o.start(); o.stop(AC.currentTime+dur); }catch(e){} }
function fanfare(){ [523,659,784,1046].forEach((f,i)=> setTimeout(()=>beep(f,.12,'triangle',.2), i*150)); }
function tsukkomi(){ [440,392,349].forEach((f,i)=> setTimeout(()=>beep(f,.08,'square',.2), i*120)); }

// ===== ãƒ«ãƒ¼ãƒ— =====
function spin(){ spinning=true; loop(); }
function loop(){ if(!spinning) return; slots.forEach((s,i)=>{ const arr=[LEFT,MID,RIGHT][i]; if(Math.random()<.6){ s.textContent = arr[Math.floor(Math.random()*arr.length)]; } }); raf=requestAnimationFrame(loop); }
function doStop(){ spinning=false; cancelAnimationFrame(raf); if(Math.random()<0.35){ slots.forEach((s,i)=> s.textContent = CORRECT[i]); } check(); }

function check(){ const vals=slots.map(s=>s.textContent); const ok=vals.every((v,i)=> v===CORRECT[i]); ok? success(): fail(vals); }

// ===== æˆåŠŸ/å¤±æ•—è¡¨ç¤º =====
function success(){
  showMsg(`ğŸ‰ ${CORRECT.join('ã¨')}`,'success');
  const msg=document.getElementById('msg'); msg.classList.add('pop'); setTimeout(()=>msg.classList.remove('pop'),700);
  document.body.classList.add('flash'); setTimeout(()=>document.body.classList.remove('flash'),500);
  const rays=document.getElementById('rays'); const rb=document.getElementById('rainbow'); if(rays)rays.classList.add('on'); if(rb)rb.classList.add('on');
  fanfare(); confetti();
  setTimeout(()=>{ if(rays)rays.classList.remove('on'); if(rb)rb.classList.remove('on'); }, 2600);
}
function fail(vals){ tsukkomi(); const m=["èª°ï¼Ÿ","é•ã†ï¼","ãŠã—ã„ï¼","ãˆï¼Ÿèª°ï¼Ÿ","çŸ¥ã‚‰ã‚“äººï¼"]; showMsg(`${vals.join('ã¨')}<span class="tuk">âŒ ${m[Math.floor(Math.random()*m.length)]}</span>`,'fail'); }

function showMsg(html,type){ const el=document.getElementById('msg'), cont=document.getElementById('msgContent'); cont.innerHTML=html; el.className=`msg show ${type||''}`; setTimeout(()=> el.classList.remove('show'), 2500); }

// ===== ç´™å¹é›ª =====
function confetti(){ const c=document.getElementById('confetti'); if(!c) return; const ctx=c.getContext('2d'); c.width=innerWidth; c.height=innerHeight; const parts=[]; for(let i=0;i<140;i++){ parts.push({x:innerWidth/2,y:innerHeight/3,vx:(Math.random()-.5)*6,vy:-Math.random()*5-2,g:.1+Math.random()*.05,r:2+Math.random()*3,a:1}) } let t=0; (function ani(){ ctx.clearRect(0,0,c.width,c.height); parts.forEach(p=>{ p.x+=p.vx; p.y+=p.vy; p.vy+=p.g; p.a*=.992; ctx.globalAlpha=p.a; ctx.fillStyle=`hsl(${(p.x+p.y)%360},90%,70%)`; ctx.beginPath(); ctx.arc(p.x,p.y,p.r,0,Math.PI*2); ctx.fill(); }); ctx.globalAlpha=1; if(t++<180) requestAnimationFrame(ani); })(); }

// ===== ã‚¤ãƒ™ãƒ³ãƒˆ =====
document.getElementById('btnStart').addEventListener('click', spin);
document.getElementById('btnStop').addEventListener('click', doStop);
</script>
</body>
</html>
