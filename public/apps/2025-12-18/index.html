<!doctype html>
<html lang="ja">
<head>
  <!-- OGP AUTO-GENERATED START (do not edit by hand) -->
  <meta property="og:title" content="まつむ割り人形">
  <meta name="twitter:title" content="まつむ割り人形">
  <meta property="og:description" content="タップしてみてください">
  <meta name="twitter:description" content="タップしてみてください">
  <meta property="og:image" content="/apps/2025-12-18/assets/nutcracker_close.png">
  <meta name="twitter:image" content="/apps/2025-12-18/assets/nutcracker_close.png">
  <meta property="og:url" content="/apps/2025-12-18/index.html">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <!-- OGP AUTO-GENERATED END -->

<meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width,initial-scale=1,viewport-fit=cover,user-scalable=no"
  />
  <title>まつむ割り人形</title>
  <style>
    :root {
      --bg: #000;
      --ink: #fff;
      --muted: #aaa;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      min-height: 100vh;
      background: var(--bg);
      color: var(--ink);
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: system-ui, -apple-system, BlinkMacSystemFont,
        "Segoe UI", sans-serif;
    }

    .wrap {
      text-align: center;
    }

    .nutcracker {
      width: min(70vw, 320px);
      cursor: pointer;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
    }

    .caption {
      margin-top: 16px;
      font-size: 14px;
      color: var(--muted);
      line-height: 1.6;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <img
      id="nutcracker"
      class="nutcracker"
      src=""
      alt="まつむ割り人形"
    />
    <p id="caption" class="caption">
      タップしてみてください
    </p>
  </div>

  <script type="module">
    // Vercel / ローカル両対応のパス解決（他の日付と同じルール）
    const DATE_SEGMENT = (location.pathname.match(/\d{4}-\d{2}-\d{2}/) || [""])[0];
    const DATE_BASE = DATE_SEGMENT ? `/${DATE_SEGMENT}/` : "/";
    const asset = (p) => {
      const clean = String(p || "").replace(/^\.?\//, "");
      return `${DATE_BASE}${clean}`;
    };

    const img = document.getElementById("nutcracker");
    const caption = document.getElementById("caption");

    let isOpen = false;

    const CLOSE_IMG = asset("./assets/nutcracker_close.png");
    const OPEN_IMG  = asset("./assets/nutcracker_open.png");

    img.src = CLOSE_IMG;

    let count = 0;

    const murmurs = [
  "アゴが外れた…",
  "はぁ…",
  "何回タップすんねん",
  "あ、そこ弱点…"

];
    let lastWasMurmur = false;

    img.addEventListener("click", () => {
      isOpen = !isOpen;
      img.src = isOpen ? OPEN_IMG : CLOSE_IMG;

      const shouldMurmur = Math.random() < 0.2 && !lastWasMurmur;

      if (shouldMurmur) {
        const text = murmurs[Math.floor(Math.random() * murmurs.length)];
        caption.textContent = text;
        lastWasMurmur = true;
      } else {
        caption.textContent = "...";
        lastWasMurmur = false;
      }
    });

  </script>
</body>
</html>
